<!DOCTYPE html>
<!-- HTML5 Hello world by kirupa - http://www.kirupa.com/html5/getting_your_feet_wet_html5_pg1.htm -->
<html lang="en-us">

<head>
<meta charset="utf-8">
<title>Hello...</title>
</head>

<body>
	<pre>
		Завдання #1:
		Напишіть функцію typeOfArray();
		Функція приймає масив та виводить  у консоль статистику з кількістю значень різних типів даних у ньому.
		Наприклад виклик
		typesOfArray([1, 'a', 'b', {}, {}]);
		Повинен вивести у консоль:
		
		"Array types stat:
		 - sting:  2 items,
		 - number: 1 item,
		 - object: 2 items
		 
		Функція повинна визначати всі типи даних: 'number', 'string', 'boolean', 'null', 'undefined', 'object'
		<button onclick='ex_1(); return false'>Выполнить</button>
	</pre>
	<hr>
	<pre>
		Завдання #2:
		Напишіть додаткові функції для роботи з масивами:
		
		 - rangeToArray (rangeStart, rangeStop, rangeStep) - повертає масив чисел, від починаючи від rangeStart(включно) і закінчуючи 
		rangeStop(включно), 
		з кроком rangeStep. При чому, функція базуючись на аргументах сама визначає, 
		чи буде послідовність чисел висхідною, чи низхідною. Тобто:
		
		console.log(rangeToArray(1, 3, 1)); // -> [1, 2, 3]
		console.log(rangeToArray(5, 3, 1)); // -> [5, 3, 3]
		
		 - sumArray(). Повертає суму всіх елементів масиву
		 console.log(sumArray([10, 20, 20])); // -> 50
		 
		 - multiplyArray(). Повертає добуток всіх елементів масиву
		 console.log(multiplyArray([2, 3, 4])); // -> 24
		 console.log(multiplyArray(rangeToArray(1, 5, 1)); // -> 120
		 
		 - reverseArray([1, 2, 3]). Повертає масив елементів, записаний у зворотньому порядку
		console.log(reverseArray([1, 2, 3])); // -> [3, 2, 1]
		<button onclick='ex_2(); return false'>Выполнить</button>
	</pre>
	<hr>
	<pre>
		Завдання #3:
		Реалізуйте синтаксичний аналізатор, який працює за наступними правилами:
		Програма повинна працювати  у такій послідовності.
		1) Спочатку, використовуючи prompt(), програма просить користувача ввести текст. Довжина тексту повинна бути від 1 до 140 символів
		В разі помилки, ми просимо користувача ввести текс з допустимою кількістю символів. 
		
		2) Наш аналізатор повинен проаналізувати ввеедений користувачем текс на пердмет дублювання розділових знаків та знаків пунктувацї*.
		Якщо ми знайшли  у тексті повторення - дублювання автоматично замінює подвоєння на один знак. 
		
		3) Після корекції подвоєнь, ми ще раз проходимо по тексту, та підраховуємо відсоткову кількість розділових знаків та знаків пунктуації відносно довжини тексту
		І Виводимо у консоль результат  у форматі:
		
		 'Hey, here's Your original message:'
		 
		 '%Текст_введений_користувачем%'
		 
		 'We've found some mistakes, so corrected them for You:'
		 
		 '%Відкорегований_текст%'
		 
		 '%відсоток_розділових_знаків%, of the text are punctuation marks!'
		 
		 Примітки: 
		 - розділові знаки, на які проводиться перевірка повинні знаходитися  у масиві:
		 var punctuations = [',', '.', '!', '?', '-', ':', ';'];
		ви можете зміню вати його на ваш розсуд;
		<button onclick='ex_3(); return false'>Выполнить</button>
	</pre>
	<hr>
<script> 

	Array.prototype.typesOfArray = function(){
		var types = {
			undefined: '[object Undefined]',
			array:     '[object Array]',
			object:    '[object Object]',
			null:      '[object Null]',
			number:    '[object Number]',
			string:    '[object String]',
			boolean:   '[object Boolean]'
		}
		function get_type(variable){
			var raw_type = Object.prototype.toString.call( variable )
			var type = 'unknown_type'
			for (i in types) { if ( types[i] === raw_type){type = i; break;} }
			return type
		}
		return this.reduce(function(obj, value, index){
			var type = get_type(value);
			obj[type] === undefined ? (obj[type] = 1) : obj[type]++
			return obj
		}, {})
	}
	Array.prototype.sum = function(){
		return this.reduce(function(sum, value){ return sum += value})
	}
	Array.prototype.multiple = function(){
		return this.reduce(function(multiple, value){ return multiple *= value})
	}
	Array.prototype.reverse_my = function(){
		return this.reduceRight(function(arr, value){arr.push(value); return arr},[])
	}
	Array.rangeToArray = function(rangeStart, rangeStop, rangeStep){
		var start, end, result = [], is_up = (rangeStart < rangeStop)
		function check_range(){ return is_up ? rangeStart <= rangeStop : rangeStart >= rangeStop }
		function iterate(){return rangeStart = is_up ? (rangeStart + rangeStep) : (rangeStart - rangeStep) }
		for (; check_range(); iterate()) { result.push(rangeStart) }
		return result
	}
	RegExp.escape= function(s) {
		return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
	};
	function ex_1 () {
		var types_count = [1, 'a', {}, [], undefined, true, null, null].typesOfArray()
		for (var k in types_count){	console.log('type %s = %i', k, types_count[k]) }
	}
	
	function ex_2(){
		console.log('rangeToArray(5, 3, 3) => %s', Array.rangeToArray(5, 3, 3))
		console.log('rangeToArray(1, 2, 10) => %s', Array.rangeToArray(1, 2, 10))
		console.log('rangeToArray(10, 2, 2) => %s', Array.rangeToArray(10, 2, 2))
		console.log('=====================================================')
		console.log('[1,2,3,4].sum() => %s', [1,2,3,4].sum())
		console.log('[1,2,3,4,10].sum() => %s', [1,2,3,4, 10].sum())
		console.log('=====================================================')
		console.log('[1,2,3,4].multiple() => %s', [1,2,3,4].multiple())
		console.log('[1,2,3,4,10].multiple() => %s', [1,2,3,4, 10].multiple())
		console.log('=====================================================')
		console.log('[1,2,3,4,10].reverse_my() => %s', [1,2,3,4, 10].reverse_my())
	}
	function ex_3(){
		var punctuations = [',', '.', '!', '?', '-', ':', ';']
		var text = ''
		while(!text){
			if (text.length < 1 || text.length > 140){
				 text = prompt('введите текст от 1 до 140 символов')
			}
		}
		var new_text = text
		punctuations.forEach(function(punct){
			new_text = new_text.replace(new RegExp(RegExp.escape(punct) + "+", 'g'), punct)
		});
		console.log(text)
		
		var count = 0
		punctuations.forEach(function(punct){
			count += (new_text.match(new RegExp(RegExp.escape(punct), 'g')) || []).length
		});
		console.log( "Hey, here's Your original message:", text)
		console.log(text)
		console.log("We've found some mistakes, so corrected them for You:")
		console.log(new_text)
		console.log(count)
		console.log('%i, of the text are punctuation marks!', count*100/new_text.length)
	}
	</script>
</body>
</html>
